//     Backbone Events 0.0.1
//
//     by Ian Storm Taylor
//     https://github.com/ianstormtaylor/backbone-events
(function(a,b){if(typeof define=="function"&&define.amd)define(["underscore","backbone"],function(c,d){b(a,c)});else{if(a.Backbone===undefined)throw new Error("Couldn't find Backbone");a.Backbone.mixin||(a.Backbone.mixin={}),a.Backbone.mixin.events=b(a,a._,a.Backbone)}})(this,function(a,b,c){return function(){var a=this.prototype.constructor;this.prototype.constructor=function(){a.apply(this,arguments),this.delegateBackboneEvents()},this.prototype.delegateBackboneEvents=function(a){a||(a=this.backboneEvents)||(a={}),this._backboneEvents||(this._backboneEvents=[]),this.undelegateBackboneEvents();for(var b in a){var d=/\s*,\s*/,e=/(\w+)(\.(\w+))?/,f,g,h,i=b.split(d),j=this,k=this;if(i.length===2){var l=e.exec(i[0]);j=this[l[1]],j instanceof c.Model&&l[3]&&(j=j.attributes[l[3]])}g=i.length===1?i[0]:i[1];if(!g)throw new Error("Invalid event");f=typeof a[b]=="string"?[a[b]]:a[b];for(var m=0,n;n=f[m];m++){n=n.split(d);var o=e.exec(n[0]);this[o[1]]&&(h=o[3]?this[o[1]][o[3]]:this[o[1]]);if(this[o[1]]&&o[3]&&this[o[1]][o[3]]===undefined||this[o[1]]===undefined&&o[3]===undefined)throw new Error("Cant find method");n[1]&&this[n[1]]&&n[1]!=="this"?k=this[n[1]]:o[3]&&this[o[1]]&&(k=this[o[1]]),j&&h&&k&&(j.on(g,h,k),this._backboneEvents.push([j,g,h,k]))}}},this.prototype.undelegateBackboneEvents=function(){if(!this._backboneEvents||this._backboneEvents.length===0)return;for(var a=0,b;b=this._backboneEvents[a];a++)b[0].off(b[1],b[2],b[3])}}});